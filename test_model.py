# -*- coding: utf-8 -*-
"""
Created on Sun Mar 17 17:29:45 2019

@author: lenovo
"""
import numpy as np 
import pandas as pd
import tensorflow as tf
from keras.models import load_model
from sklearn.externals import joblib
from collections import Counter

df_test = pd.read_pickle('C:\\Users\\lenovo\\Desktop\\project\\test_data.pkl')
test_x = np.array(list(df_test['transform_data'])).reshape((len(df_test),232))
test_y = np.array(list(df_test['labels']))

model = load_model('best_model.h5')
a = model.predict(test_x)

threshold = 0.8
b=[]
for i in a:
    if i>threshold:
        b.append(1)
    else:
        b.append(0)

count = 0
for i in range(len(test_x)):
    if b[i] == test_y[i]:
        count+=1
acc = count/len(test_x)        
print('accuracy of the model is :%f', acc)